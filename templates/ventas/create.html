<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Crear Venta</title>
    <link rel="stylesheet" href="/static/css/style.css" />
</head>
<body>
    <nav class="navbar">
        <a href="/">Inicio</a>
        <div class="dropdown">
            <button class="dropbtn">Categorías</button>
            <div class="dropdown-content">
                <a href="/categorias/create">Crear Categoría</a>
                <a href="/categorias/read">Ver Categorías</a>
                <a href="/categorias/update">Actualizar Categoría</a>
                <a href="/categorias/delete">Eliminar Categoría</a>
            </div>
        </div>
        <div class="dropdown">
            <button class="dropbtn">Productos</button>
            <div class="dropdown-content">
                <a href="/productos/create">Crear Producto</a>
                <a href="/productos/read">Ver Productos</a>
                <a href="/productos/update">Actualizar Producto</a>
                <a href="/productos/delete">Eliminar Producto</a>
            </div>
        </div>
        <div class="dropdown">
            <button class="dropbtn">Clientes</button>
            <div class="dropdown-content">
                <a href="/clientes/create">Crear Cliente</a>
                <a href="/clientes/read">Ver Clientes</a>
                <a href="/clientes/update">Actualizar Cliente</a>
                <a href="/clientes/delete">Eliminar Cliente</a>
            </div>
        </div>
        <div class="dropdown">
            <button class="dropbtn">Ventas</button>
            <div class="dropdown-content">
                <a href="/ventas/create">Crear Venta</a>
                <a href="/ventas/read">Ver Ventas</a>
            </div>
        </div>
        <a href="/historial">Historial</a>
        <a href="/developer-info">Información del Desarrollador</a>
        <a href="/planning">Planificación</a>
        <a href="/design">Diseño</a>
        <a href="/informacion-del-proyecto">Información del Proyecto</a>
    </nav>
    <div class="container">
        <h1>Crear Nueva Venta</h1>

        {% if error_message %}
            <div style="color: red; margin-bottom: 20px; padding: 10px; border: 1px solid red; background-color: #ffe6e6;">
                {{ error_message }}
            </div>
        {% endif %}

        {% if success %}
            <div style="color: green; margin-bottom: 20px; padding: 10px; border: 1px solid green; background-color: #e6ffe6;">
                Venta creada exitosamente. ID: {{ venta.id }}
            </div>
        {% endif %}

        <div class="form-section">
            <form method="post" action="/ventas/" enctype="multipart/form-data">
                <label for="cliente_id">ID del Cliente:</label>
                <input type="number" id="cliente_id" name="cliente_id" required />

                <label for="canal_venta">Canal de Venta:</label>
                <select id="canal_venta" name="canal_venta" required>
                    <option value="presencial">Presencial</option>
                    <option value="virtual">Virtual</option>
                </select>

                <label for="fecha_venta">Fecha de Venta:</label>
                <input type="datetime-local" id="fecha_venta" name="fecha_venta" required />

                <!-- Aquí se pueden agregar detalles de productos dinámicamente -->
                <div id="detalles">
                    <h3>Detalles de la Venta</h3>
                    <div class="detalle-item">
                        <label for="producto_id_1">ID del Producto:</label>
                        <input type="number" id="producto_id_1" name="producto_id_1" required />

                        <label for="cantidad_1">Cantidad:</label>
                        <input type="number" id="cantidad_1" name="cantidad_1" required />

                        <label for="precio_unitario_1">Precio Unitario:</label>
                        <input type="number" id="precio_unitario_1" name="precio_unitario_1" step="0.01" required />
                    </div>
                </div>

                <button type="button" onclick="addDetalle()">Agregar Detalle</button>

                <button type="submit">Crear Venta</button>
            </form>
        </div>
    </div>

    <script>
        let detalleCount = 1;

        function addDetalle() {
            detalleCount++;
            const detallesDiv = document.getElementById('detalles');
            const newDetalle = document.createElement('div');
            newDetalle.className = 'detalle-item';
            newDetalle.innerHTML = `
                <label for="producto_id_${detalleCount}">ID del Producto:</label>
                <input type="number" id="producto_id_${detalleCount}" name="producto_id_${detalleCount}" required />

                <label for="cantidad_${detalleCount}">Cantidad:</label>
                <input type="number" id="cantidad_${detalleCount}" name="cantidad_${detalleCount}" required />

                <label for="precio_unitario_${detalleCount}">Precio Unitario:</label>
                <input type="number" id="precio_unitario_${detalleCount}" name="precio_unitario_${detalleCount}" step="0.01" required />
            `;
            detallesDiv.appendChild(newDetalle);
        }
    </script>
</body>
</html>
